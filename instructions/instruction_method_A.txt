# Agent Instructions for Method A: Multi-Instance Majority Voting

## Repository
https://github.com/auto-res2/kg-extraction-majority-voting

## Base Experiment Repository (Primary Reference)
https://github.com/auto-res2/kg-extraction-experiment

This is the primary reference for understanding the experiment context, methodology, results,
and technical details. The README there contains comprehensive documentation including all
model configurations, thinking budget explanations, structured outputs, evaluation methodology,
and more. Read it before starting any work to understand the full experimental design.

## Subagent Usage (MANDATORY)
You MUST use subagents for all work. Never do large implementations directly.
- Use subagents (Task tool with appropriate subagent_type) for all implementation, testing, and git operations.
- Use the **coder** subagent for all code implementation and modifications -- never implement large changes directly.
- Use the **Explore** subagent for code exploration and understanding the codebase.
- Use the **Bash** subagent for running experiments, executing commands, and git operations.

## Task
Clone the repository, implement the method described in README.md, and run the experiment.

## API Keys
- GEMINI_API_KEY=(see secrets .env file)
- OPENAI_API_KEY=(see secrets .env file)

## Setup
```bash
git clone https://github.com/auto-res2/kg-extraction-majority-voting
cd kg-extraction-majority-voting
git clone https://github.com/YoumiMa/JacRED /tmp/JacRED
pip install google-genai
export GEMINI_API_KEY="<YOUR_GEMINI_API_KEY>"
```

## What to Do
1. Read the README.md thoroughly -- it contains the full experiment specification
2. The base implementation (Baseline + Two-Stage) is already provided in the repo
3. Implement the new method described in section 6 of the README
4. Run the experiment: all conditions (Baseline, Two-Stage, New Method) on the same 10 dev documents
5. The output should show a comparison table with P/R/F1 for all conditions
6. Commit and push results (results.json + updated code) to the repository

## Model Configuration
- Use model: gemini-3-flash-preview
- Set thinking_budget=0 in llm_client.py for fastest execution
- If you need to change model settings, edit llm_client.py

## Expected Output
A comparison table like:
```
              Precision   Recall     F1    TP    FP    FN
Baseline           ...      ...    ...   ...   ...   ...
Two-Stage          ...      ...    ...   ...   ...   ...
MajorityVote       ...      ...    ...   ...   ...   ...
```

## Local Directories
- This method's working directory: /Users/kumacmini/systems/kg-extraction-majority-voting/
- Base experiment (reference): /Users/kumacmini/systems/kg_extraction/

## Important Notes
- Do NOT modify evaluation.py (entity alignment + P/R/F1 computation) -- keep evaluation consistent
- Do NOT change the 10 evaluation documents or few-shot example
- The JacRED dataset must be at /tmp/JacRED/
- All results should be reproducible
